# CFnew - ุชุฑููุงู v2.9.3

**ุฒุจุงู:** [ไธญๆ](README.md) | [ูุงุฑุณ](ูุงุฑุณ.md)

[ฺฏุฑูู ุชูฺฏุฑุงู](https://t.me/+ft-zI76oovgwNmRh)

## ๐ ููุฑุณุช ูุทุงูุจ

1.  [ูุนุฑู ู ุงูฺฉุงูุงุช](#ูุนุฑู-ู-ุงูฺฉุงูุงุช)
2.  [ููุงูู ฺฉูุฏ: ูุซุงู ูพุณุชฺ (The Mailman Analogy)](#ููุงูู-ฺฉูุฏ-ูุซุงู-ูพุณุชฺ-the-mailman-analogy)
3.  [ูุนูุงุฑ ุณุณุชู ู ุฌุฑุงู ุชุฑุงูฺฉ (System Architecture)](#ูุนูุงุฑ-ุณุณุชู-ู-ุฌุฑุงู-ุชุฑุงูฺฉ-system-architecture)
4.  [ุฏุงูุดูุงูู ูพฺฉุฑุจูุฏ (Configuration Encyclopedia)](#ุฏุงูุดูุงูู-ูพฺฉุฑุจูุฏ-configuration-encyclopedia)
    *   [ฑ. ููุช ู ุงุญุฑุงุฒ ููุช (Identity)](#ฑ-ููุช-ู-ุงุญุฑุงุฒ-ููุช-identity)
    *   [ฒ. ุดุจฺฉู ู ุฑูู (Network & Relay)](#ฒ-ุดุจฺฉู-ู-ุฑูู-network--relay)
    *   [ณ. ุชูุธู ูพุฑูุชฺฉูโูุง (Protocols)](#ณ-ุชูุธู-ูพุฑูุชฺฉูโูุง-protocols)
    *   [ด. ฺฉูุชุฑู ููุทู (Logic Control)](#ด-ฺฉูุชุฑู-ููุทู-logic-control)
    *   [ต. ุชุฑุฌุญุงุช ู ูพุดุฑูุชู (Preferred & Advanced)](#ต-ุชุฑุฌุญุงุช-ู-ูพุดุฑูุชู-preferred--advanced)
5.  [ุจุฑุฑุณ ุนูู ูพุฑูุชฺฉูโูุง (Protocol Deep Dive)](#ุจุฑุฑุณ-ุนูู-ูพุฑูุชฺฉูโูุง-protocol-deep-dive)
    *   [Native ุฏุฑ ุจุฑุงุจุฑ Link-Only](#native-ุฏุฑ-ุจุฑุงุจุฑ-link-only)
    *   [ุชฺฉููููฺ ECH ฺุณุชุ](#ุชฺฉููููฺ-ech-ฺุณุช)
6.  [ุณูุงุฑููุง ุงุณุชูุงุฏู ู ุจูุชุฑู ุฑูุดโูุง](#ุณูุงุฑููุง-ุงุณุชูุงุฏู-ู-ุจูุชุฑู-ุฑูุดโูุง-scenarios)
7.  [ุฑุงูููุง ูุตุจ ุงุฒ ุตูุฑ (Zero to Hero)](#ุฑุงูููุง-ูุตุจ-ุงุฒ-ุตูุฑ-zero-to-hero)
8.  [ุฑุงูููุง ุชูุธูุงุช ฺฉูุงูุช](#ุฑุงูููุง-ุชูุธูุงุช-ฺฉูุงูุช)
9.  [ุนุจโุงุจ (Troubleshooting)](#ุนุจโุงุจ-troubleshooting)
10. [ูุฏุฑุช API](#ูุฏุฑุช-api)
11. [ุชุงุฑุฎฺู ุณุชุงุฑู](#ุชุงุฑุฎฺู-ุณุชุงุฑู)

---

## ูุนุฑู ู ุงูฺฉุงูุงุช

CFnew ฺฉ ุงุณฺฉุฑูพุช ูพุฑูฺฉุณ ููู ูู ุญุฑู ุงุณุช ฺฉู ุจุฑ ุฑู Cloudflare Workers ุงุฌุฑุง ูโุดูุฏ. ุงู ุงุจุฒุงุฑ ุงุฒ ุดุจฺฉู ุฌูุงู ูุจู (Edge) ฺฉููุฏููุฑ ุงุณุชูุงุฏู ูโฺฉูุฏ ุชุง ุงุชุตุงู ุณุฑุนุ ุงูู ู ููุงูู ุฏุฑ ุจุฑุงุจุฑ ููุชุฑูฺฏ ุจุฑุง ุดูุง ูุฑุงูู ฺฉูุฏ.

*   **ูพุดุชุจุงู ููุฒูุงู ูพุฑูุชฺฉูโูุง**: ูพุฑุฏุงุฒุด ุจูู (Native) ูพุฑูุชฺฉูโูุง VLESS, Trojan, VLESS gRPC, xhttp ู ุชููุฏ ููฺฉ ุงุดุชุฑุงฺฉ ุจุฑุง VMess, Shadowsocks, TUIC, Hysteria 2.
*   **ูพููุงูโุณุงุฒ ุจุงูุง**: ูพุดุชุจุงู ุงุฒ ูุณุฑ ูุฎู (Hidden Path) ู ุตูุญู ุฎูุดโุขูุฏฺฏู ุฌุนู (Camouflage) ุจุฑุง ุดุจูโุณุงุฒ ฺฉุงูู ฺฉ ูุจโุณุงุช ุนุงุฏ.
*   **ูุฏุฑุช ฺฏุฑุงูฺฉ**: ุฏุงุฑุง ูพูู ูุจ ุฏุงุฎู ฺฉู ุชูุธูุงุช ุฑุง ุฏุฑ KV ุฐุฎุฑู ูโฺฉูุฏุ ุชุบุฑ ุขู ุชูุธูุงุช ุจุฏูู ูุงุฒ ุจู ฺฉุฏููุณ.
*   **ูุฏุฑุช ููุดููุฏ ุชุฑุงูฺฉ**: ฺฉูพุงุฑฺูโุณุงุฒ ุดุฏู ุจุง ูุงุจูุชโูุง ProxyIP (ุฑูู)ุ ูุฏุฑุช IPูุง ุชูุฒุ ูพุฑูฺฉุณ DoH ู ุชุณุช ุชุงุฎุฑ.
*   **ุฎูุฏฺฉุงุฑุณุงุฒ**: ูพุดุชุจุงู ุงุฒ API ุจุฑุง ููุดุชู ุงุณฺฉุฑูพุช ู ุขูพุฏุช ุฎูุฏฺฉุงุฑ IPูุง ุชูุฒ.

---

## ููุงูู ฺฉูุฏ: ูุซุงู ูพุณุชฺ (The Mailman Analogy)

ุจุฑุง ุฏุฑฺฉ ฺฉุงูู ูุญูู ฺฉุงุฑ ูพุฑูฺฉุณ ู ุนุจูุฑ ุงุฒ ููุชุฑูฺฏุ ุจุงุฏ ุขู ุฑุง ุจู ฺฉ **ุณุณุชู ูพุณุช** ุชุดุจู ฺฉูู.

### ููุดโูุง
*   **ุดูุง (Client)**: ูุฑุณุชูุฏู ูุงูู.
*   **ุณุงุช ููุตุฏ (Google/YouTube)**: ฺฏุฑูุฏู ูุงูู.
*   **ููุชุฑฺ (Firewall)**: ุจุงุฒุฑุณ ุณุฎุชโฺฏุฑ ุงุฏุงุฑู ูพุณุช ฺฉู ุงุฌุงุฒู ุงุฑุณุงู ูุงูู ุจู "ูุณุช ุณุงู" ุฑุง ููโุฏูุฏ.
*   **Cloudflare Worker**: ฺฉุงุฑููุฏ ฺฉ ุดุฑฺฉุช ูพุณุช ูุนุชุจุฑ ู ุจูโุงูููู ุฏุฑ ููุทูู ุขุฒุงุฏ.
*   **UUID**: ูููุฑ ูุฎุตูุต ุง ฺฏุฐุฑูุงูู ุดูุง.
*   **ProxyIP**: ูพฺฉ ููุชูุฑ ูุฎู.

### ูุฑุงุญู ุงูุฌุงู ฺฉุงุฑ

#### ฑ. ุจุณุชูโุจูุฏ (The Envelope)
ุดูุง ูโุฎูุงูุฏ ุจู ฺฏูฺฏู ูุงูู ุจููุณุฏุ ุงูุง ุงฺฏุฑ ุฑู ูพุงฺฉุช ุจููุณุฏ "ฺฏุฑูุฏู: ฺฏูฺฏู"ุ ููุชุฑฺ ุขู ุฑุง ูพุงุฑู ูโฺฉูุฏ.
*   **ุงูุฏุงู**: ุดูุง ูุงูู ุงุตู (ุฏุงุฏูโูุง ุฑูุฒฺฏุฐุงุฑ ุดุฏู) ุฑุง ุฏุงุฎู ฺฉ ูพุงฺฉุช ุงุฏุงุฑ ูุนููู ูโฺฏุฐุงุฑุฏ ฺฉู ุฑู ุขู ููุดุชู ุดุฏู **"ฺฏุฑูุฏู: ุดุฑฺฉุช Cloudflare"**.
*   **ุงุญุฑุงุฒ ููุช**: ุฑู ุฏุฑ ูพุงฺฉุชุ **ูููุฑ UUID** ุฎูุฏ ุฑุง ูโุฒูุฏ. ููุท Worker ฺฉู ูุณุช ูููุฑูุง ุฑุง ุฏุงุฑุฏ ูโูููุฏ ุงู ูุงูู ูุนุชุจุฑ ุงุณุช.
*   **ูพุฑูุชฺฉู**: ุงู ุฏููุงู ฺฉุงุฑ ุงุณุช ฺฉู ูพุฑูุชฺฉูโูุง **VLESS/Trojan** ุงูุฌุงู ูโุฏููุฏุ ูุฎูโุณุงุฒ ู ุจุณุชูโุจูุฏ.

#### ฒ. ุชุญูู ุจู ูพุณุช (Transmission)
*   **ุงูุฏุงู**: ูุงูู ุฑุง ุจู ุตูุฏูู ูพุณุช ูโุงูุฏุงุฒุฏ.
*   **ุจุงุฒุฑุณ**: ููุชุฑฺ ูุงูู ุฑุง ูโุจูุฏ. ฺูู ฺฏุฑูุฏู "Cloudflare" (ฺฉ ุดุฑฺฉุช ูุนุชุจุฑ ุงูุชุฑูุช) ุงุณุช ู ุธุงูุฑ ูุงูู ฺฉุงููุงู ุฑุณู ู ุงูู (HTTPS/TLS) ุงุณุชุ ุจู ุขู ุดฺฉ ููโฺฉูุฏ ู ุงุฌุงุฒู ุนุจูุฑ ูโุฏูุฏ.
*   **ูุชุฌู**: ูุงูู ุดูุง ุงุฒ ุณุฏ ููุชุฑูฺฏ ุนุจูุฑ ูโฺฉูุฏ ู ุจู ุงูุจุงุฑ Cloudflare ูโุฑุณุฏ.

#### ณ. ุชูฺฉฺฉ (Sorting - The Worker)
*   **ุฏุฑุงูุช**: Worker ูุงูู ุฑุง ุชุญูู ูโฺฏุฑุฏ.
*   **ุจุฑุฑุณ**: ุงุจุชุฏุง **ูููุฑ UUID** ุฑุง ฺฺฉ ูโฺฉูุฏ.
    *   *ูููุฑ ุงุดุชุจุงู ุงุณุชุ* -> ูุงูู ุฏูุฑ ุฑุฎุชู ูโุดูุฏ (ูุทุน ุงุชุตุงู).
    *   *ูููุฑ ุฏุฑุณุช ุงุณุชุ* -> ูพุงฺฉุช ุจุฑูู ุฑุง ุจุงุฒ ูโฺฉูุฏ.
*   **ุฎูุงูุฏู**: Worker ูุงูู ุงุตู ุฑุง ูโุจูุฏ ู ูุชูุฌู ูโุดูุฏ ฺฏุฑูุฏู ูุงูุน **"Google"** ุงุณุช.

#### ด. ุชูุฒุน (Delivery Methods)
ุญุงูุง Worker ุฏู ุฑูุด ุจุฑุง ุฑุณุงูุฏู ูุงูู ุฏุงุฑุฏ (ุจุณุชู ุจู ุชูุธูุงุช ุดูุง):

*   **๐ฐ๏ธ ุชุญูู ูุณุชูู (Native Mode)**
    *   Worker ุดุฎุตุงู ุงุฒ ุงูุจุงุฑ ุฎุงุฑุฌ ูโุดูุฏุ ุจู ุฏูุชุฑ ฺฏูฺฏู ูโุฑูุฏ ู ูุงูู ุฑุง ุชุญูู ูโุฏูุฏ.
    *   *ูฺฺฏ*: ุณุฑุนุช ุจุงูุงุ ุงูุง ฺฏูฺฏู ฺูุฑู Worker (ุขโูพ ฺฉููุฏููุฑ) ุฑุง ูโุจูุฏ.

*   **๐ฑ๏ธ ูพฺฉ ูุฎู (ProxyIP Mode)**
    *   Worker ูฺฉุฑ ูโฺฉูุฏ ุฑูุชู ูุณุชูู ุฎุทุฑูุงฺฉ ุงุณุช (ุง ฺฏูฺฏู ุงุฒ ฺฉููุฏููุฑ ุฎูุดุด ููโุขุฏ). ูพุณ ูุงูู ุฑุง ุจู ฺฉ **ูพฺฉ ููุชูุฑ ูุฎู (ProxyIP)** ูโุฏูุฏ.
    *   ูพฺฉ ูุงูู ุฑุง ุจู ฺฏูฺฏู ูโุฑุณุงูุฏ.
    *   *ูฺฺฏ*: ฺฏูฺฏู ููุท ฺูุฑู ูพฺฉ (ุขโูพ ูุณฺฉูู/ูุญู) ุฑุง ูโุจูุฏ. ุนุงู ุจุฑุง ุจุงุฒ ฺฉุฑุฏู ูุชููฺฉุณ.

#### ต. ูพุงุณุฎ (The Reply)
*   ฺฏูฺฏู ุฌูุงุจ ูุงูู ุฑุง ูโููุณุฏ ู ุจู Worker (ุง ูพฺฉ) ูโุฏูุฏ.
*   Worker ุฌูุงุจ ุฑุง ุฏุฑ ฺฉ ูพุงฺฉุช ุจุง ูููุฑ **"ูุฑุณุชูุฏู: Cloudflare"** ูโฺฏุฐุงุฑุฏ.
*   ูุงูู ุจู ุฏุณุช ุดูุง ูโุฑุณุฏ. ููุชุฑฺ ููุท ูโุจูุฏ ฺฉู ุดูุง ฺฉ ูุงูู ุงุฏุงุฑ ุงุฒ Cloudflare ุฏุฑุงูุช ฺฉุฑุฏูโุงุฏ.

---

## ูุนูุงุฑ ุณุณุชู ู ุฌุฑุงู ุชุฑุงูฺฉ (System Architecture)

ุฏุฑฺฉ ูุญูู ุฌุฑุงู ุงุทูุงุนุงุช ฺฉูุฏ ุงุตู ูพฺฉุฑุจูุฏ ุตุญุญ ุงุณุช. CFnew ุงุฒ ฺูุงุฑ ุญุงูุช ุงุตู ุชุฑุงูฺฉ ูพุดุชุจุงู ูโฺฉูุฏ.

### ฑ. ุญุงูุช ุจูู (Native Mode)
*ููุงุณุจ ุจุฑุง: VLESS, Trojan, VLESS gRPC, xhttp*
ุฏุฑ ุงู ุญุงูุชุ Worker ูุณุชููุงู ุชุฑุงูฺฉ ุฑุง ูพุฑุฏุงุฒุด ู ุจู ุงูุชุฑูุช ูุชุตู ูโุดูุฏ. ุณุฑุนโุชุฑู ุญุงูุช ุงุณุช ุงูุง IP ุฎุฑูุฌุ IP ุฏุชุงุณูุชุฑ ฺฉููุฏููุฑ ุฎูุงูุฏ ุจูุฏ.

```mermaid
graph LR
    Client(ฺฉุงุฑุจุฑ) -->|ุชุฑุงูฺฉ ุฑูุฒูฺฏุงุฑ ุดุฏู| CF_Edge(ูุจู ฺฉููุฏููุฑ)
    CF_Edge -->|ุงุฌุฑุง| Worker(ุงุณฺฉุฑูพุช CFnew)
    Worker -->|ุฑูุฒฺฏุดุง ู ุฏุฑุฎูุงุณุช| Target(ุณุงุช ููุตุฏ/YouTube)
```

### ฒ. ุญุงูุช ProxyIP (ุฑูู)
*ููุงุณุจ ุจุฑุง: VLESS, Trojan (ุจุง ูุชุบุฑ p)*
Worker ูพุณ ุงุฒ ุฏุฑุงูุช ุฏุฑุฎูุงุณุชุ ุขู ุฑุง ุงุฒ ุทุฑู TCP ุจู ฺฉ ุณุฑูุฑ ูุงุณุท (ProxyIP) ูโูุฑุณุชุฏ. ููุงุณุจ ุจุฑุง ุนุจูุฑ ุงุฒ ุชุญุฑูโูุง ูุชููฺฉุณ ุง ูุฎู ฺฉุฑุฏู IP ูุฑฺฉุฑ.

```mermaid
graph LR
    Client(ฺฉุงุฑุจุฑ) -->|ุชุฑุงูฺฉ ุฑูุฒูฺฏุงุฑ ุดุฏู| CF_Edge
    CF_Edge -->|ุงุฌุฑุง| Worker
    Worker -->|ููุฑูุงุฑุฏ TCP| ProxyIP(ุณุฑูุฑ ูุงุณุท)
    ProxyIP -->|ุฏุฑุฎูุงุณุช ููุง| Target(Netflix/ChatGPT)
```

### ณ. ุญุงูุช ูุณุชูู Link-Only (Direct)
*ููุงุณุจ ุจุฑุง: TUIC, Hysteria 2*
ุฏุฑ ุงู ุญุงูุช Worker **ููุท ุณุงุฒูุฏู ููฺฉ ุงุดุชุฑุงฺฉ** ุงุณุช. ุชุฑุงูฺฉ **ุจุฏูู ุนุจูุฑ** ุงุฒ ฺฉููุฏููุฑ ูุณุชููุงู ุจู ุณุฑูุฑ ุจฺฉโุงูุฏ ุดูุง ูโุฑูุฏ.

```mermaid
graph LR
    Client(ฺฉุงุฑุจุฑ) -->|ุฏุฑุงูุช ฺฉุงููฺฏ| Worker(ููุท ููฺฉ ุณุงุฒ)
    Client -->|ุชุฑุงูฺฉ UDP| Backend(ุณุฑูุฑ ุดูุง: Hysteria2/TUIC)
```

### ด. ุญุงูุช ุฑูู Link-Only (Relay)
*ููุงุณุจ ุจุฑุง: VMess, Shadowsocks (ุจุง ูุชุบุฑูุง evm/ess)*
Worker ฺฉ ุชููู WebSocket ุงุฌุงุฏ ฺฉุฑุฏู ู ุชุฑุงูฺฉ ุฑุง ุจู ุณุฑูุฑ ุจฺฉโุงูุฏ ุดูุง ูุฏุงุช ูโฺฉูุฏ.

```mermaid
graph LR
    Client(ฺฉุงุฑุจุฑ) -->|ุชุฑุงูฺฉ WS| CF_Edge
    CF_Edge -->|ุงุฌุฑุง| Worker
    Worker -->|ููุฑูุงุฑุฏ WS| Backend(ุณุฑูุฑ ุดูุง: VMess/SS)
```

---

## ุฏุงูุดูุงูู ูพฺฉุฑุจูุฏ (Configuration Encyclopedia)

ุฏุฑ ุงูุฌุง ุชูุงู ูุชุบุฑูุง ููุฌูุฏ ุฏุฑ ฺฉุฏ ุฑุง ุจุฑุฑุณ ูโฺฉูู.
**ุงูููุช**: ุชูุธูุงุช KV (ูพูู ฺฏุฑุงูฺฉ) > ูุชุบุฑูุง ูุญุท (Settings).

### ฑ. ููุช ู ุงุญุฑุงุฒ ููุช (Identity)

<div dir="rtl">

| ูุงู ูุชุบุฑ | ููุน | ูพุดโูุฑุถ | ุชูุถุญุงุช | ูุซุงู |
| :--- | :--- | :--- | :--- | :--- |
| **`u`** | String | (ุงูุฒุงู) | **UUID**. ุดูุงุณู ฺฉุชุง ฺฉุงุฑุจุฑ. ุฑูุฒ ุนุจูุฑ ุงุชุตุงู ุดูุง. | `84439981-04b6...` |
| **`tp`** | String | `u` | **ุฑูุฒ Trojan**. ุฑูุฒ ุงุฎุชุตุงุต ุจุฑุง ูพุฑูุชฺฉู ุชุฑูุฌุงู. ุงฺฏุฑ ุฎุงู ุจุงุดุฏ ุงุฒ UUID ุงุณุชูุงุฏู ูโุดูุฏ. | `mysecurepass` |

</div>

### ฒ. ุดุจฺฉู ู ุฑูู (Network & Relay)

<div dir="rtl">

| ูุงู ูุชุบุฑ | ููุน | ูพุดโูุฑุถ | ุชูุถุญุงุช | ูุซุงู |
| :--- | :--- | :--- | :--- | :--- |
| **`p`** | String | (ุฎุงู) | **ProxyIP**. ููุตุฏ ููุฑูุงุฑุฏ ุชุฑุงูฺฉ (IP:Port). ุจุฑุง ุฑูุน ุชุญุฑู ุง ูุฎูโุณุงุฒ. | `1.2.3.4` |
| **`s`** | String | (ุฎุงู) | **SOCKS5**. ูุฑูุช `user:pass@host:port`. ุงูููุช ุจุงูุงุชุฑ ุงุฒ `p` ุฏุงุฑุฏ. | `u:p@1.1.1.1:1080` |
| **`d`** | String | (ุฎุงู) | **ูุณุฑ ูุฎู**. ุจุง ุชูุธู ุงูุ ูพูู ููุท ุงุฒ `domain.com/path` ุจุงุฒ ูโุดูุฏ. | `/secret` |
| **`wk`** | String | (ุฎูุฏฺฉุงุฑ) | **ููุทูู Worker**. ุงุฌุจุงุฑ Worker ุจู ุงุฌุฑุง ุฏุฑ ููุทูู ุฎุงุต (ูุซู SG, US). | `SG` |

</div>

### ณ. ุชูุธู ูพุฑูุชฺฉูโูุง (Protocols)

ุจุฑุง ูุนุงูโุณุงุฒ `yes` ู ุจุฑุง ุบุฑูุนุงูโุณุงุฒ `no` ูุฑุงุฑ ุฏูุฏ.

<div dir="rtl">

| ูุงู ูุชุบุฑ | ูพุฑูุชฺฉู | ููุน ูพุฑุฏุงุฒุด | ุชูุถุญุงุช | ูพุดโูุงุฒ |
| :--- | :--- | :--- | :--- | :--- |
| **`ev`** | VLESS | Native | ุณุจฺฉโุชุฑูุ ุจุฏูู ูุถุนุช (Stateless)ุ ุจูุชุฑู ุนููฺฉุฑุฏ. | - |
| **`et`** | Trojan | Native | ุดุจูโุณุงุฒ ุชุฑุงูฺฉ HTTPSุ ููุงูู ุฏุฑ ุจุฑุงุจุฑ ุงุฎุชูุงู. | - |
| **`ex`** | xhttp | Native | ูพุฑูุชฺฉู ูุฎูโุณุงุฒ ูุจุชู ุจุฑ HTTP POST. | ูพุดุชุจุงู gRPC |
| **`eg`** | VLESS gRPC | Native | ุงูุชูุงู ุงุฒ ุทุฑู gRPC. | ฺฉูุงูุช ุณุงุฒฺฏุงุฑ |
| **`evm`** | VMess | Relay | ููุท ุชููุฏ ููฺฉ. ูุงุฒ ุจู ุณุฑูุฑ ุจฺฉโุงูุฏ ุฏุงุฑุฏ. | ุณุฑูุฑ ุจฺฉโุงูุฏ |
| **`ess`** | Shadowsocks | Relay | ููุท ุชููุฏ ููฺฉ. ูุงุฒ ุจู ุณุฑูุฑ ุจฺฉโุงูุฏ ุฏุงุฑุฏ. | ุณุฑูุฑ ุจฺฉโุงูุฏ |
| **`etu`** | TUIC | Direct | ููุท ุชููุฏ ููฺฉ. ูพุฑูุชฺฉู UDP. | ุณุฑูุฑ ุจฺฉโุงูุฏ |
| **`ehy`** | Hysteria 2 | Direct | ููุท ุชููุฏ ููฺฉ. ูพุฑูุชฺฉู UDP. | ุณุฑูุฑ ุจฺฉโุงูุฏ |
| **`ech`** | ECH | - | ูุนุงูโุณุงุฒ Encrypted Client Hello. | ูพุดุชุจุงู DoH |

</div>

### ด. ฺฉูุชุฑู ููุทู (Logic Control)

<div dir="rtl">

| ูุงู ูุชุบุฑ | ุนููฺฉุฑุฏ | ูพุดโูุฑุถ | ุชูุถุญุงุช |
| :--- | :--- | :--- | :--- |
| **`rm`** | Region Match | `yes` | **ุชุทุจู ููุทูู**. ุขุง Worker ุจู ุทูุฑ ููุดููุฏ ุจู ูุฒุฏฺฉโุชุฑู ููุฏ ูุชุตู ุดูุฏุ |
| **`qj`** | Downgrade | `yes` | **ฺฉูุชุฑู ุงูุช**. ุงฺฏุฑ `no` ุจุงุดุฏุ ูุงูโุจฺฉ ุฎูุฏฺฉุงุฑ (CF Direct -> ProxyIP) ูุนุงู ูโุดูุฏ. |
| **`dkby`** | Port Filter | `no` | **ููุชุฑ ูพูุฑุช**. ุงฺฏุฑ `yes` ุจุงุดุฏุ ููุท ููุฏูุง TLS (443) ุณุงุฎุชู ูโุดููุฏ. |
| **`yxby`** | Prefer Filter | `no` | **ููุชุฑ ุชุฑุฌุญ**. ุงฺฏุฑ `yes` ุจุงุดุฏุ ุชูุงู IPูุง ุชูุฒ **ุบุฑูุนุงู** ูโุดููุฏ. |
| **`ae`** | API Enable | `no` | **ูุฏุฑุช API**. ุงฺฏุฑ `yes` ุจุงุดุฏุ ุฏุณุชุฑุณ API ุจุงุฒ ูโุดูุฏ. |
| **`scu`** | SubConverter | (ุฏุงุฎู) | **ูุจุฏู ุงุดุชุฑุงฺฉ**. ุขุฏุฑุณ ุณุฑูุณ ุชุจุฏู ููฺฉ VLESS ุจู Clash/Surge. |
| **`homepage`** | Camouflage | (ุฎุงู) | **ุงุณุชุชุงุฑ**. ุขุฏุฑุณ ุณุงุช ฺฉู ุฏุฑ ุฑุดู ุฏุงููู `/` ููุงุด ุฏุงุฏู ูโุดูุฏ. |

</div>

### ต. ุชุฑุฌุญุงุช ู ูพุดุฑูุชู (Preferred & Advanced)

<div dir="rtl">

| ูุงู ูุชุบุฑ | ุชูุถุญุงุช | ูพุดโูุฑุถ |
| :--- | :--- | :--- |
| **`yx`** | **ูุณุช ุฏุณุช IPูุง ุชูุฒ**. ุจุงูุงุชุฑู ุงูููุช. ูุฑูุช: `IP:Port#Name`. | - |
| **`yxURL`** | **ููุจุน ุฑุงู ุฏูุฑ IP**. ุฌุงฺฏุฒู ููุจุน ูพุดโูุฑุถ ูโุดูุฏ. ููฺฉ ูุงู TXT. | (ูพุดโูุฑุถ) |
| **`epd`** | ุขุง ูุณุช **ุฏุงูููโูุง ุชูุฒ** ุฏุงุฎู ูุนุงู ุจุงุดุฏุ | `no` |
| **`epi`** | ุขุง **IPูุง ุชูุฒ ูพูุง** (wetest) ูุนุงู ุจุงุดูุฏุ | `true` |
| **`egi`** | ุขุง ููุจุน IPูุง **GitHub** ูุนุงู ุจุงุดุฏุ | `true` |
| **`ipv4`** | ุฏุฑุงูุช IPูุง IPv4 ุชูุฒ. | `yes` |
| **`ipv6`** | ุฏุฑุงูุช IPูุง IPv6 ุชูุฒ. | `yes` |
| **`ispMobile`** | ุดุงูู ฺฉุฑุฏู IPูุง ููุงุณุจ **ููุฑุงู ุงูู**. | `yes` |
| **`ispTelecom`**| ุดุงูู ฺฉุฑุฏู IPูุง ููุงุณุจ **ูุฎุงุจุฑุงุช**. | `yes` |
| **`ispUnicom`** | ุดุงูู ฺฉุฑุฏู IPูุง ููุงุณุจ **ุงุฑุงูุณู/ุฑุงุชู**. | `yes` |
| **`customDNS`** | ุขุฏุฑุณ DoH ุจุฑุง ุงุณุชุนูุงู ECH. | `https://dns.joeyblog.eu.org/joeyblog` |
| **`customECHDomain`** | ุฏุงููู ูุฏู ุจุฑุง ุฏุฑุงูุช ฺฉุงููฺฏ ECH. | `cloudflare-ech.com` |

</div>

---

## ุจุฑุฑุณ ุนูู ูพุฑูุชฺฉูโูุง (Protocol Deep Dive)

### Native ุฏุฑ ุจุฑุงุจุฑ Link-Only

*   **Native (ูพุฑุฏุงุฒุด ุจูู)**: Worker ุฏุงุฑุง ูพุดุชู ูพุฑูุชฺฉู ฺฉุงูู ุงุณุช ู ูโุชูุงูุฏ ุชุฑุงูฺฉ ุฑุง ุฑูุฒฺฏุดุง ู ูพุฑุฏุงุฒุด ฺฉูุฏ.
    *   *ูุฒุงุง*: ุจุฏูู ูุงุฒ ุจู ุณุฑูุฑ ุงุถุงููุ ุฑุงฺฏุงูุ ุณุฑุนุช ุจุงูุง.
    *   *ูุนุงุจ*: ูุญุฏูุฏ ุจู ูุญุท Cloudflare Worker (ุจุฏูู ุดููุฏ UDPุ ูพูุฑุชโูุง ูุญุฏูุฏ).
*   **Link-Only (ููุท ููฺฉ)**: Worker ููุท ููุด ูุฑฺฉุฒ ุชูุฒุน ฺฉุงููฺฏ ุฑุง ุฏุงุฑุฏ. ูพุฑุฏุงุฒุด ุงุตู ุชุฑุงูฺฉ ุชูุณุท VPS ุดูุง ุงูุฌุงู ูโุดูุฏ.
    *   *ฺุฑุง ูุงุฒู ุงุณุชุ*: Cloudflare Workers ูุงุจูุช **Listen UDP** ูุฏุงุฑูุฏุ ูพุณ ููโุชูุงููุฏ ุณุฑูุฑ Hysteria 2 ุง TUIC ุจุงุดูุฏ.
    *   *ูุณุฑ ุชุฑุงูฺฉ*: ฺฉูุงูุช -> VPS ุดูุง (Worker ุงูุฌุง ููุท ฺฉ ุฏูุชุฑฺู ุชููู ุงุณุช).

### ุชฺฉููููฺ ECH ฺุณุชุ

**Encrypted Client Hello (ECH)** ุชฺฉููููฺ ุฌุฏุฏ ุงุณุช ุจุฑุง ุฑูุฒฺฏุฐุงุฑ ูุฑุญูู ุฏุณุช ุฏุงุฏู TLS (Client Hello)ุ ุจู ูฺู ุฑูุฒฺฏุฐุงุฑ **SNI (Server Name Indication)**.

1.  **ูุดฺฉู**: ุฏุฑ TLS ุณูุชุ SNI ุจู ุตูุฑุช ูุชู ุจุงุฒ (Cleartext) ุงุฑุณุงู ูโุดูุฏ. ููุชุฑฺ ูโุจูุฏ ุดูุง ุจู `google.com` ูุตู ุดุฏูโุงุฏ ู ุขู ุฑุง ูุทุน ูโฺฉูุฏ.
2.  **ุฑุงู ุญู**: ECH ูุงู ุฏุงููู (SNI) ุฑุง ุฑูุฒฺฏุฐุงุฑ ูโฺฉูุฏ. ููุชุฑฺ ููุท ูโุจูุฏ ุดูุง ุจู Cloudflare ูุตู ุดุฏูโุงุฏุ ุงูุง ููโุฏุงูุฏ ฺฉุฏุงู ุณุงุช.
3.  **ูพุงุฏูโุณุงุฒ ุฏุฑ Worker**:
    *   Worker ุจุง ุงุณุชูุงุฏู ุงุฒ `customDNS` (ฺฉู ุจุงุฏ DoH HTTPS ุจุงุดุฏ) ุชูุธูุงุช ECH ุฏุงููู `customECHDomain` ุฑุง ูโฺฏุฑุฏ.
    *   Worker ุงู ุชูุธูุงุช ุฑุง ุฏุฑ ููฺฉโูุง VLESS/Trojan ุชุฒุฑู ูโฺฉูุฏ.
    *   ฺฉูุงูุช ุจุง ุงุณุชูุงุฏู ุงุฒ ุงู ุชูุธูุงุชุ ุงุทูุงุนุงุช ููุฏุดฺฉ ุฑุง ุฑูุฒฺฏุฐุงุฑ ูโฺฉูุฏ.

---

## ุณูุงุฑููุง ุงุณุชูุงุฏู ู ุจูุชุฑู ุฑูุดโูุง (Scenarios)

### ุณูุงุฑู ฑ: ุนุจูุฑ ุงุฒ ุชุญุฑู (Netflix/YouTube)
ูุฏู: ุฏุณุชุฑุณ ุจู ูุญุชูุง ูุญุฏูุฏ ุดุฏู ุฌุบุฑุงูุง.
1.  ฺฉ ProxyIP ุณุงูู ูพุฏุง ฺฉูุฏ (ูุซูุงู IP ุณูฺฏุงูพูุฑ).
2.  ุฏุฑ KV ููุฏุงุฑ `p = 1.2.3.4:443` (ุขุฏุฑุณ ProxyIP) ุฑุง ุชูุธู ฺฉูุฏ.
3.  ููุฏุงุฑ `wk = SG` ุฑุง ุชูุธู ฺฉูุฏ (ุงุฌุจุงุฑ ุจู ุงุณุชูุงุฏู ุงุฒ ููุฏ ุณูฺฏุงูพูุฑ ุจุฑุง ฺฉุงูุด ูพูฺฏ).
4.  ูุณุฑ ุงุชุตุงู: ฺฉูุงูุช -> Worker -> ProxyIP (ุณูฺฏุงูพูุฑ) -> Netflix.

### ุณูุงุฑู ฒ: ุงููุช ู ุงุณุชุชุงุฑ ุญุฏุงฺฉุซุฑ (Paranoid Mode)
ูุฏู: ุฌููฺฏุฑ ุงุฒ ุดูุงุณุง ุชูุณุท ุฑุจุงุชโูุง ู ููุชุฑูฺฏ SNI.
1.  ุชูุธู `d = /my-super-secret-path`. ููุท ฺฉุณุงู ฺฉู ุงู ูุณุฑ ุฑุง ุฏุงุฑูุฏ ูพูู ุฑุง ูโุจููุฏ.
2.  ุชูุธู `ech = yes`. ุฑูุฒฺฏุฐุงุฑ SNI ุจุฑุง ุฌููฺฏุฑ ุงุฒ ุชุดุฎุต ุฏุงููู ููุตุฏ.
3.  ุชูุธู `tp = ุฑูุฒ_ูู`. ูุงู ุฏูู ุงููุช ุจุฑุง ูพุฑูุชฺฉู Trojan.
4.  ุชูุธู `homepage = https://www.varzesh3.com`. ุจุงุฒุฏุฏ ุงุฒ ุฑุดู ุฏุงูููุ ุณุงุช ูุฑุฒุด ณ ุฑุง ูุดุงู ูโุฏูุฏ.

### ุณูุงุฑู ณ: ุงุณุชูุฑุงุฑ ุชุฑฺฉุจ (Hybrid)
ูุฏู: ุณุฑุนุช ูุจโฺฏุฑุฏ + ูพูฺฏ ูพุงู ุจุงุฒ.
1.  ุฑูุดู ฺฉุฑุฏู `ev = yes` (VLESS) ุจุฑุง ูุจโฺฏุฑุฏ ุฑูุฒูุฑู (ุงุณุชูุงุฏู ุงุฒ CDN ฺฉููุฏููุฑ).
2.  ุฑูุดู ฺฉุฑุฏู `ehy = yes` (Hysteria 2) ู ุงุชุตุงู ุจู VPS ุดุฎุต.
3.  ุฏุฑ ฺฉูุงูุช ูุฑ ุฏู ุฑุง ุงุถุงูู ฺฉูุฏ.
    *   ูุฏู/ุฏุงูููุฏ ุจุง VLESS (ุตุฑููโุฌู ุฏุฑ ุชุฑุงูฺฉ VPS).
    *   ุจุงุฒ/ุชูุงุณ ุตูุช ุจุง Hysteria 2 (ุชุงุฎุฑ UDP ูพุงู).

---

## ุฑุงูููุง ูุตุจ ุงุฒ ุตูุฑ (Zero to Hero)

### ฑ. ุงุณุชูุฑุงุฑ Worker
1.  ูุฑูุฏ ุจู ุฏุงุดุจูุฑุฏ Cloudflare -> **Workers & Pages** -> **Create Worker**.
2.  ุงูุชุฎุงุจ ูุงู (ูุซูุงู `cf-proxy`) -> **Deploy**.
3.  ุฏฺฉูู **Edit Code** -> ฺฉูพ ฺฉุฑุฏู ูุญุชูุง `snippets` ุง `_worker.js` -> **Save and deploy**.

### ฒ. ูพฺฉุฑุจูุฏ KV (ุงูุฒุงู!)
1.  ูุณุฑ **Workers & Pages** -> **KV** -> **Create Namespace** -> ูุงู `CONFIG` -> **Add**.
2.  ุจุงุฒฺฏุดุช ุจู Worker -> **Settings** -> **Variables** -> **KV Namespace Bindings**.
3.  ุงูุฒูุฏู Binding -> ูุงู ูุชุบุฑ: `C` (ุญุฑูู ุจุฒุฑฺฏ) -> ูุถุง ูุงู: `CONFIG` -> **Save**.

### ณ. ุฑุงูโุงูุฏุงุฒ ุงููู
1.  ูุณุฑ **Settings** -> **Variables** -> **Environment Variables**.
2.  ุงูุฒูุฏู ูุชุบุฑ `u` = `ฺฉุฏ UUID ุดูุง`.
3.  ุฑูุชู ุจู ุขุฏุฑุณ `https://your-domain/YOUR-UUID` ุจุฑุง ูุฑูุฏ ุจู ูพูู.

---

## ุฑุงูููุง ุชูุธูุงุช ฺฉูุงูุช

ุจุฑุง ุจูุชุฑู ูุชุฌูุ ุชูุธูุงุช ุฒุฑ ุฑุง ุงุนูุงู ฺฉูุฏ:

### v2rayNG (ุงูุฏุฑูุฏ)
*   **Mux (ฺูุฏูพุฎุด)**: ูพุดููุงุฏ ูโุดูุฏ **ุฎุงููุด** ุจุงุดุฏ.
*   **Allow Insecure**: ุงฺฏุฑ ุฏุงููู ุดุฎุต ูุฏุงุฑุฏุ ุฑู `true` ุจฺฏุฐุงุฑุฏ.
*   **Sniffing**: ุญุชูุงู **ุฑูุดู** ุจุงุดุฏ.

### Shadowrocket (iOS)
*   **Allow Insecure**: ุฏุฑ ุชูุธูุงุช ูุนุงู ุดูุฏ.
*   **Update on Open**: ุฑูุดู ฺฉูุฏ ุชุง ููุดู IPูุง ุชูุฒ ุฌุฏุฏ ุฑุง ุจฺฏุฑุฏ.

### Clash Meta / Mihomo (PC/Android)
*   **ูุณุชู (Kernel)**: ุญุชูุงู ุงุฒ **Meta** ุงุณุชูุงุฏู ฺฉูุฏ. ูุณุชู Premium ูุฏู ุงุฒ ูฺฺฏโูุง ุฌุฏุฏ ูพุดุชุจุงู ููโฺฉูุฏ.
*   **Fingerprint**: ุฑู `chrome` ุชูุธู ุดูุฏ.

---

## ุนุจโุงุจ (Troubleshooting)

<div dir="rtl">

| ฺฉุฏ ุฎุทุง | ุนูุช ุงุญุชูุงู | ุฑุงู ุญู |
| :--- | :--- | :--- |
| **1101** | ุฎุทุง ุงุณฺฉุฑูพุช Worker | 1. ฺฺฉ ฺฉูุฏ KV ุจู ูุชุบุฑ `C` ูุชุตู ุดุฏู ุจุงุดุฏ.<br>2. ฺฉุฏ ุฑุง ฺฉุงูู ฺฉูพ ฺฉูุฏ. |
| **1033** | ุฎุทุง ุชููู Argo | ูุดฺฉู ุฏุงุฎู ุดุจฺฉู Cloudflare ุงุณุชุ ูุนูููุงู ุฎูุฏุจูโุฎูุฏ ุญู ูโุดูุฏ. |
| **502** | Bad Gateway | **ุฎุฑุงุจ ProxyIP**. ูุฑฺฉุฑ ููโุชูุงูุฏ ุจู ุขุฏุฑุณ `p` ูุตู ุดูุฏ. ProxyIP ุฑุง ุนูุถ ฺฉูุฏ. |
| **522** | Connection Timed Out | **ุชุงูโุงูุช**. ูุฑฺฉุฑ ููโุชูุงูุฏ ุจู ููุตุฏ ุจุฑุณุฏ. ุงุญุชูุงูุง IP ููุชุฑ ุดุฏู ุงุณุช. |
| **Timeout** | ุนุฏู ุงุชุตุงู | 1. ฺฺฉ ฺฉุฑุฏู `u` (UUID).<br>2. ฺฺฉ ฺฉุฑุฏู TLS ฺฉูุงูุช.<br>3. ุงุณุชูุงุฏู ุงุฒ IP ุชูุฒ. |

---

## ูุฏุฑุช API

**ุขุฏุฑุณ ูพุงู**: `https://your-domain/path/api/preferred-ips`

### ฑ. ุฏุฑุงูุช ูุณุช
```bash
curl -X GET https://domain.com/uuid/api/preferred-ips
```

### ฒ. ุงูุฒูุฏู IP
```bash
curl -X POST https://domain.com/uuid/api/preferred-ips \
  -H "Content-Type: application/json" \
  -d '{"ip": "1.2.3.4", "port": 443, "name": "SG-Optimized"}'
```

### ณ. ุญุฐู IP
```bash
curl -X DELETE https://domain.com/uuid/api/preferred-ips \
  -H "Content-Type: application/json" \
  -d '{"ip": "1.2.3.4"}'
```

### ด. ูพุงฺฉุณุงุฒ ฺฉุงูู
```bash
curl -X DELETE https://domain.com/uuid/api/preferred-ips \
  -H "Content-Type: application/json" \
  -d '{"all": true}'
```

---

## ุชุงุฑุฎฺู ุณุชุงุฑู

[![Star History Chart](https://api.star-history.com/svg?repos=byJoey/cfnew&type=Timeline)](https://www.star-history.com/#byJoey/cfnew&Timeline&LogScale)
