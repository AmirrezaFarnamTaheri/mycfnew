# CFnew - Ultimate Terminal v2.9.3

**زبان:** [English](README.md) | [中文](README_ZH.md) | [فارسی](فارسی.md)

[گروه تلگرام](https://t.me/+ft-zI76oovgwNmRh)

---

## شروع سریع (TL;DR)

1. فایل `worker.js` (یا `worker_obfuscated.js`) را روی یک Cloudflare Worker جدید دیپلوی کنید.
2. متغیر محیطی `u` را برابر UUID خود قرار دهید.
3. KV را با نام متغیر `C` متصل کنید.
4. وارد `https://<worker>.workers.dev/<UUID>` شوید.
5. از داشبورد لینک اشتراک بسازید.

---

## CFnew چیست؟

**CFnew** یک سامانه پروکسی مبتنی بر Cloudflare Workers است که ترافیک را شبیه وب‌گردی معمولی نشان می‌دهد و یک داشبورد ماتریکسی برای مدیریت و بهینه‌سازی ارائه می‌دهد.

**چرا متفاوت است؟**
- **بدون سرور**: نیازی به VPS نیست، روی Edgeهای Cloudflare اجرا می‌شود.
- **رفتار چندگانه**: برای افراد ناشناس یک وب‌سایت عادی است، برای کاربر مجاز یک پروکسی.
- **مدیریت ساده**: همه تنظیمات از طریق داشبورد ذخیره و مدیریت می‌شود.
- **سخت‌تر برای مسدودسازی**: ترافیک مثل HTTPS عادی به Cloudflare دیده می‌شود.

---

## سازوکار کلی (نسخه کوتاه)

- **`/`** صفحه ترمینال را نمایش می‌دهد.
- **`/<UUID>`** داشبورد را باز می‌کند (UUID معتبر لازم است).
- **`/<UUID>/sub`** لینک اشتراک تولید می‌کند.
- **`/<مسیر سفارشی>`** با تنظیم `d` جایگزین UUID می‌شود.

---

## ویژگی‌ها

- تولید چند پروتکل: **VLESS**، **Trojan**، **VMess**، **Shadowsocks**، **Hysteria2**، **TUIC**
- تطبیق هوشمند منطقه و فالبک
- تست تاخیر و مدیریت ProxyIP
- پشتیبانی اختیاری ECH (از طریق DoH)
- تبدیل داخلی لینک اشتراک
- کنسول دیباگ در داشبورد
- رابط سه‌زبانه (English / 中文 / فارسی)

---

## نقشه داشبورد

- **System Status**: منطقه Worker، روش تشخیص، IP فعلی، وضعیت تطبیق
- **Config Management**: ذخیره/خواندن/ریست تنظیمات KV
- **Latency Test**: تست گروهی، فیلتر شهر، افزودن به لیست ترجیحی
- **Advanced Control**: کنترل پروتکل‌ها، TLS-only، استراتژی downgrade، API
- **Links**: لینک‌های اشتراک برای کلاینت‌ها

---

## متغیرهای مهم (خلاصه)

| متغیر | کاربرد | نمونه |
|---|---|---|
| `u` | UUID (رمز شما) | `8485...5823` |
| `d` | مسیر سفارشی داشبورد | `/secret-panel` |
| `p` | ProxyIP برای مخفی‌سازی IP اصلی | `1.2.3.4:443` |
| `s` | پراکسی SOCKS5 | `user:pass@host:port` |
| `wk` | تنظیم منطقه Worker | `US` / `SG` / `JP` |
| `yx` | لیست IP ترجیحی | `1.1.1.1:443#HK,...` |
| `yxURL` | منبع لیست IP | `https://example.com/ips.txt` |
| `rm` | تطبیق منطقه | `no` برای غیرفعال |
| `qj` | downgrade | `no` برای فعال (مستقیم → SOCKS5 → فالبک) |
| `dkby` | فقط TLS | `yes` فعال |
| `yxby` | غیرفعال کردن ترجیحی‌ها | `yes` فعال |
| `ae` | اجازه API | `yes` فعال |
| `ech` | فعال‌سازی ECH | `yes` فعال |
| `customDNS` | DoH برای ECH | `https://dns.example/dns-query` |
| `customECHDomain` | دامنه ECH | `cloudflare-ech.com` |
| `tp` | رمز Trojan | `custom-pass` |
| `homepage` | صفحه اصلی جعلی | `https://example.com` |
| `scu` | تبدیل اشتراک | `https://url.v1.mk/sub` |

> تنظیمات بیشتری در داشبورد وجود دارد: GitHub defaults، چندپورتی، IPv4/IPv6، فیلتر ISP و ... فهرست کامل در `docs/REFERENCE_FA.md`.

---

## سناریوهای رایج

### 1) دسترسی با UUID
- `d` را خالی بگذارید.
- وارد `/<UUID>` شوید.

### 2) حالت مسیر سفارشی
- `d=/مسیر-مخفی` را تنظیم کنید.
- UUID غیرفعال می‌شود و از مسیر سفارشی استفاده می‌کنید.

### 3) حداقل راه‌اندازی
- فقط `u` + اتصال KV را تنظیم کنید.
- لینک اشتراک بسازید و وارد کلاینت کنید.

---

## رفع مشکل سریع

- **در حالت “Checking...” گیر می‌کند**: کنسول دیباگ را باز کنید؛ خطاهای `/region` یا `/sub` را ببینید.
- **UUID معتبر نیست**: مطمئن شوید نام متغیر `u` است، نه `uuid`؛ فاصله نداشته باشد.
- **خطای KV**: KV را با نام `C` متصل کنید و دوباره دیپلوی کنید.
- **لینک اشتراک خالی**: آدرس `/<UUID>/sub` را مستقیم باز کنید.

---

## چک‌لیست امنیتی

- لینک UUID را عمومی نکنید.
- برای داشبورد مسیر سفارشی `d` بگذارید.
- دسترسی داشبورد را با Cloudflare Access یا IP allowlist محدود کنید.
- در صورت لو رفتن UUID، سریع آن را تغییر دهید.

---

## مستندات

- **Walkthrough**: `docs/WALKTHROUGH_FA.md`
- **Deployment**: `docs/DEPLOYMENT_FA.md`
- **Analogy**: `docs/ANALOGY_FA.md`
- **DNS Encoding**: `docs/DNS_ENCODING_FA.md`
- **Full Reference**: `docs/REFERENCE_FA.md`

---

## سلب مسئولیت

این پروژه صرفاً برای آموزش و تحقیق است و مسئولیت سوءاستفاده بر عهده کاربر است.
