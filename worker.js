var e=null,t={};function n(e,n=""){return void 0!==t[e]?t[e]:n}function o(){return{...t}}var a={en:{title:"Terminal",terminal:"Terminal v2.9.3",congratulations:"Congratulations, you made it!",enterU:"Please enter your U variable",enterD:"Please enter your D variable",command:"Command: connect [",uuid:"UUID",path:"PATH",inputU:"Enter U variable content and hit Enter...",inputD:"Enter D variable content and hit Enter...",connecting:"Connecting...",invading:"Invading...",success:"Connection established! Returning result...",error:"Error: Invalid UUID format",reenter:"Please re-enter a valid UUID",debugConsoleTitle:"Debug Console",debugShow:"Show",debugHide:"Hide",debugReady:"Console Ready",debugUnknownError:"Unknown Error",dashTitle:"Config Dashboard",sysStatus:"System Status",configMgmt:"Config Management",latencyTest:"Latency Test",protocolSel:"Protocol Selection",saveConfig:"Save Config",loadConfig:"Load Config",resetConfig:"Reset Config",testLatency:"Test Latency",region:"Region",ip:"IP",method:"Method",loading:"Loading...",saved:"Saved successfully",failed:"Failed"},fa:{title:"ترمینال",terminal:"ترمینال",congratulations:"تبریک می‌گوییم به شما",enterU:"لطفاً مقدار متغیر U خود را وارد کنید",enterD:"لطفاً مقدار متغیر D خود را وارد کنید",command:"دستور: connect [",uuid:"UUID",path:"PATH",inputU:"محتویات متغیر U را وارد کرده و Enter را بزنید...",inputD:"محتویات متغیر D را وارد کرده و Enter را بزنید...",connecting:"در حال اتصال...",invading:"در حال نفوذ...",success:"اتصال موفق! در حال بازگشت نتیجه...",error:"خطا: فرمت UUID نامعتبر",reenter:"لطفاً UUID معتبر را دوباره وارد کنید",debugConsoleTitle:"کنسول اشکال‌زدایی",debugShow:"نمایش",debugHide:"پنهان کردن",debugReady:"کنسول آماده است",debugUnknownError:"خطای ناشناخته",dashTitle:"داشبورد تنظیمات",sysStatus:"وضعیت سیستم",configMgmt:"مدیریت تنظیمات",latencyTest:"تست تأخیر",protocolSel:"انتخاب پروتکل",saveConfig:"ذخیره تنظیمات",loadConfig:"بارگذاری تنظیمات",resetConfig:"بازنشانی تنظیمات",testLatency:"تست سرعت",region:"منطقه",ip:"آی‌پی",method:"روش",loading:"در حال بارگذاری...",saved:"با موفقیت ذخیره شد",failed:"خطا"},zh:{title:"终端",terminal:"终端 v2.9.3",congratulations:"恭喜，你成功了！",enterU:"请输入 U 变量的值",enterD:"请输入 D 变量的值",command:"命令: connect [",uuid:"UUID",path:"PATH",inputU:"输入 U 变量内容并按回车...",inputD:"输入 D 变量内容并按回车...",connecting:"连接中...",invading:"入侵中...",success:"连接成功！正在返回结果...",error:"错误：无效的 UUID 格式",reenter:"请重新输入有效的 UUID",debugConsoleTitle:"调试控制台",debugShow:"显示",debugHide:"隐藏",debugReady:"控制台就绪",debugUnknownError:"未知错误",dashTitle:"配置仪表盘",sysStatus:"系统状态",configMgmt:"配置管理",latencyTest:"延迟测试",protocolSel:"协议选择",saveConfig:"保存配置",loadConfig:"加载配置",resetConfig:"重置配置",testLatency:"测试延迟",region:"区域",ip:"IP",method:"方法",loading:"加载中...",saved:"保存成功",failed:"失败"}},s=[{name:"Cloudflare",url:"https://cloudflare-dns.com/dns-query",weight:20},{name:"Google",url:"https://dns.google/dns-query",weight:15},{name:"Quad9",url:"https://dns.quad9.net/dns-query",weight:15},{name:"OpenDNS",url:"https://doh.opendns.com/dns-query",weight:10},{name:"AdGuard",url:"https://dns.adguard.com/dns-query",weight:10},{name:"ControlD",url:"https://freedns.controld.com/p2",weight:10},{name:"Mullvad",url:"https://adblock.dns.mullvad.net/dns-query",weight:10},{name:"NextDNS",url:"https://dns.nextdns.io/dns-query",weight:10}];function r(e,t){return e>>>t|e<<32-t}atob("aW52YWxpZCBkYXRh"),atob("aW52YWxpZCB1c2Vy"),atob("Y29tbWFuZCBpcyBub3Qgc3VwcG9ydGVk"),atob("VURQIHByb3h5IG9ubHkgZW5hYmxlIGZvciBETlMgd2hpY2ggaXMgcG9ydCA1Mw=="),atob("aW52YWxpZCBhZGRyZXNzVHlwZQ=="),atob("YWRkcmVzc1ZhbHVlIGlzIGVtcHR5"),atob("d2ViU29ja2V0LmVhZHlTdGF0ZSBpcyBub3Qgb3Blbg=="),atob("U3RyaW5naWZpZWQgaWRlbnRpZmllciBpcyBpbnZhbGlk"),atob("SW52YWxpZCBTT0NLUyBhZGRyZXNzIGZvcm1hdA=="),atob("bm8gYWNjZXB0YWJsZSBtZXRob2Rz"),atob("c29ja3Mgc2VydmVyIG5lZWRzIGF1dGg="),atob("ZmFpbCB0byBhdXRoIHNvY2tzIHNlZWRz"),atob("ZmFpbCB0byBvcGVuIHNvY2tzIGNvbm5lY3Rpb24="),Array.from({length:256},(e,t)=>(t+256).toString(16).slice(1));var i=[80,8080,8880,2052,2082,2086,2095],l=[443,2053,2083,2087,2096,8443],d={fetch:async(d,c,p)=>(async(d,c)=>{Date.now();const p=new URL(d.url);let u;try{await(async n=>{if(n.C)try{e=n.C,await(async()=>{if(e)try{const n=await e.get("c");n&&(t=JSON.parse(n))}catch(e){t={}}})()}catch(t){e=null}else e=null})(c);const h=(c.u||c.U||"").toLowerCase();if(h)if("/dns-query"===p.pathname)u=await(async e=>{const t=new URL(e.url);if("OPTIONS"===e.method)return new Response(null,{status:204,headers:{"Access-Control-Allow-Origin":"*","Access-Control-Allow-Methods":"GET, POST, OPTIONS","Access-Control-Allow-Headers":"Content-Type, Accept","Access-Control-Max-Age":"86400"}});const n="GET"===e.method,o="POST"===e.method;if(!n&&!o)return new Response("Method not allowed",{status:405});if(n&&!t.searchParams.has("dns"))return new Response("Missing DNS query parameter",{status:400});let a=null;if(o)try{a=await e.arrayBuffer()}catch(e){return new Response("Invalid request body",{status:400})}let r="unknown";n?r=t.searchParams.get("dns"):a&&(r=`binary(${a.byteLength} bytes)`);const i=(e=>{if(!e||0===e.length)return null;const t=e.reduce((e,t)=>e+t.weight,0);let n=Math.random()*t;for(const t of e){if(n<t.weight)return t;n-=t.weight}return e[0]})(s);Date.now();try{const n=i.url+t.search,s=new Headers(e.headers);s.set(o?"Content-Type":"Accept","application/dns-message"),s.set("User-Agent","DoH-Proxy-Worker/1.0");const r=new Request(n,{method:e.method,headers:s,body:a,redirect:"follow"}),l=await fetch(r);if(!l.ok)throw Error("Upstream status "+l.status);const d=new Headers(l.headers);return d.set("Access-Control-Allow-Origin","*"),d.set("Access-Control-Allow-Methods","GET, POST, OPTIONS"),d.set("Access-Control-Allow-Headers","Content-Type, Accept"),d.set("Cache-Control","public, max-age=300"),new Response(l.body,{status:l.status,statusText:l.statusText,headers:d})}catch(n){return await(async(e,t,n,o)=>{const a=s.filter(e=>e.name!==n.name);a.sort(()=>Math.random()-.5);for(const n of a.slice(0,2)){Date.now();try{const a=n.url+t.search,s=new Headers(e.headers);s.set("POST"===e.method?"Content-Type":"Accept","application/dns-message");const r=new Request(a,{method:e.method,headers:s,body:o}),i=await fetch(r);if(i.ok){const e=new Headers(i.headers);return e.set("Access-Control-Allow-Origin","*"),new Response(i.body,{status:i.status,headers:e})}}catch(e){continue}}return new Response("All DNS providers failed",{status:503})})(e,t,i,a)}})(d);else if("/dns-encoding"===p.pathname)u=new Response("<html>\n        <head><title>DNS Encoding Explanation</title></head>\n        <body>\n            <h1>DNS Encoding Explanation</h1>\n            <p>This page explains how DNS queries are encoded.</p>\n        </body>\n        </html>",{headers:{"Content-Type":"text/html; charset=utf-8"}});else if(p.pathname.includes("/api/config"))u=((e,t)=>{if(new URL(e.url).searchParams.get("u")===t)return!0;const n=e.headers.get("Authorization");return!(!n||!n.includes(t))})(d,h)?await(async n=>{if("GET"===n.method){const e=o();return new Response(JSON.stringify({...e,kvEnabled:!0}),{headers:{"Content-Type":"application/json"}})}if("POST"===n.method)try{return(e=>{for(const[n,o]of Object.entries(e))""===o||null==o?delete t[n]:t[n]=o})(await n.json()),await(async(n,o)=>{t.updated=o,await(async()=>{if(e)try{const n=JSON.stringify(t);await e.put("c",n)}catch(e){throw e}})()})(0,(new Date).toISOString()),new Response(JSON.stringify({success:!0,message:"Config Saved"}),{headers:{"Content-Type":"application/json"}})}catch(e){return new Response(JSON.stringify({success:!1,message:e.message||"Invalid Request Body"}),{status:500})}return new Response("Method Not Allowed",{status:405})})(d):new Response(JSON.stringify({error:"Unauthorized"}),{status:401,headers:{"Content-Type":"application/json"}});else if("/"===p.pathname){const e=d.headers.get("Cookie")||"";let t="en";e.includes("preferredLanguage=zh")?t="zh":e.includes("preferredLanguage=fa")&&(t="fa");const o="fa"===t;u=new Response(((e,t,n)=>{const o=a[e||"en"]||a.en;return`<!DOCTYPE html>\n<html lang="${t}" dir="${n?"rtl":"ltr"}">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${o.title}</title>\n    <style>\n        body { background-color: #000; color: #0f0; font-family: 'Courier New', monospace; margin: 0; padding: 0; overflow: hidden; }\n        .matrix-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: -1; }\n        .terminal { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 80%; max-width: 800px; background: rgba(0, 20, 0, 0.9); border: 1px solid #0f0; box-shadow: 0 0 20px rgba(0, 255, 0, 0.2); padding: 20px; border-radius: 5px; }\n        .terminal-header { display: flex; align-items: center; border-bottom: 1px solid #333; padding-bottom: 10px; margin-bottom: 10px; }\n        .terminal-buttons { display: flex; gap: 5px; }\n        .terminal-button { width: 12px; height: 12px; border-radius: 50%; background: #555; }\n        .terminal-title { margin-left: auto; margin-right: auto; color: #888; font-size: 14px; }\n        .terminal-body { font-size: 16px; line-height: 1.5; }\n        .terminal-line { margin-bottom: 5px; display: flex; }\n        .terminal-prompt { color: #0f0; margin-right: 10px; }\n        .terminal-input { background: transparent; border: none; color: #fff; font-family: inherit; font-size: inherit; flex-grow: 1; outline: none; }\n    </style>\n</head>\n<body>\n    <div class="matrix-bg"></div>\n    <div class="terminal">\n        <div class="terminal-header">\n            <div class="terminal-buttons">\n                <div class="terminal-button"></div>\n                <div class="terminal-button"></div>\n                <div class="terminal-button"></div>\n            </div>\n            <div class="terminal-title">${o.terminal}</div>\n        </div>\n        <div class="terminal-body">\n            <div class="terminal-line">\n                <span class="terminal-prompt">root:~$</span>\n                <span>${o.congratulations}</span>\n            </div>\n            <div class="terminal-line">\n                <span class="terminal-prompt">root:~$</span>\n                <input type="text" class="terminal-input" id="uuidInput" placeholder="${o.inputU}" autofocus>\n            </div>\n        </div>\n    </div>\n    <script>\n        const uuidInput = document.getElementById('uuidInput');\n        uuidInput.addEventListener('keydown', (e) => {\n            if (e.key === 'Enter') {\n                const val = uuidInput.value.trim();\n                if (val) window.location.href = '/' + val;\n            }\n        });\n    <\/script>\n</body>\n</html>`})(t,o?"fa-IR":"zh"===t?"zh-CN":"en-US",o,n("d")),{headers:{"Content-Type":"text/html; charset=utf-8"}})}else{const e=p.pathname.split("/").filter(e=>e),t=h,s=e[0]?.toLowerCase();if(s===t){const s=e[1];if(s)u="sub"===s?await(async(e,t,o)=>{const a=new URL(e.url).hostname,s=n("yx")||"";let d=[];s&&s.split(",").forEach(e=>{e.trim()&&d.push({ip:e.trim(),port:443,isp:"Preferred",colo:"UNK"})}),0===d.length&&d.push({ip:"104.16.1.1",port:443,isp:"Cloudflare",colo:"Auto"});let c=[];c=c.concat(((e,t,n,o=null,a={})=>{const{disableNonTLS:s=!1,enableDiverseProxies:r=!1}=a,d=[],c=atob("dmxlc3M=");return e.forEach(e=>{let a=e.isp.replace(/\s/g,"_");e.colo&&e.colo.trim()&&(a=`${a}-${e.colo.trim()}`);const p=e.ip.includes(":")?`[${e.ip}]`:e.ip;let u=[];if(r)l.forEach(e=>{u.push({port:e,tls:!0})}),s||i.forEach(e=>{u.push({port:e,tls:!1})});else if(e.port){const t=parseInt(e.port);l.includes(t)?u.push({port:t,tls:!0}):i.includes(t)?s||u.push({port:t,tls:!1}):u.push({port:t,tls:!0})}else u.push({port:443,tls:!0}),s||u.push({port:80,tls:!1});u.forEach(e=>{const{port:s,tls:r}=e,i=`${a}-${s}${r?"-TLS":""}`;let l=`${c}://${t}@${p}:${s}?encryption=none&security=${r?"tls":"none"}&type=ws&host=${n}&path=${encodeURIComponent("/?ed=2048")}`;r&&(l+=`&sni=${n}&fp=randomized`,o&&(l+=`&alpn=h3,h2,http/1.1&ech=${encodeURIComponent(o)}&fp=chrome`)),l+="#"+encodeURIComponent(i),d.push(l)})}),d})(d,o,a)),c=c.concat(((e,t,n,o={})=>{const{disableNonTLS:a=!1}=o,s=[];return e.forEach(e=>{let o=e.isp.replace(/\s/g,"_");e.colo&&e.colo.trim()&&(o+="-"+e.colo.trim());const r=parseInt(e.port||443),i=l.includes(r);if(!i&&a)return;const d=btoa(JSON.stringify({v:"2",ps:o,add:e.ip,port:r,id:t,aid:"0",scy:"auto",net:"ws",type:"none",host:n,path:"/vm?ed=2048",tls:i?"tls":"",sni:i?n:"",alpn:i?"h2,http/1.1":""}));s.push("vmess://"+d)}),s})(d,o,a)),c=c.concat(((e,t,n,o={})=>{const{disableNonTLS:a=!1}=o,s=[],r=t;return e.forEach(e=>{let t=e.isp.replace(/\s/g,"_");e.colo&&e.colo.trim()&&(t+="-"+e.colo.trim());const o=parseInt(e.port||443),i=l.includes(o);if(!i&&a)return;const d=btoa("chacha20-ietf-poly1305:"+r);let c=`v2ray-plugin;mode=websocket;host=${n};path=${encodeURIComponent("/ss?ed=2048")}`;i&&(c+=";tls"),s.push(`ss://${d}@${e.ip}:${o}?plugin=${encodeURIComponent(c)}#${encodeURIComponent(t)}`)}),s})(d,o,a)),c=c.concat(await(async(e,t,n,o=null,a={})=>{const{disableNonTLS:s=!1}=a,i=[],d=await(async e=>{const t=(new TextEncoder).encode(e),n=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];let o=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428];const a=t.length,s=8*a,i=64*Math.ceil((a+9)/64),l=new Uint8Array(i);l.set(t),l[a]=128;const d=new DataView(l.buffer);d.setUint32(i-4,s,!1);for(let e=0;e<i;e+=64){const t=new Uint32Array(64);for(let n=0;n<16;n++)t[n]=d.getUint32(e+4*n,!1);for(let e=16;e<64;e++){const n=r(t[e-15],7)^r(t[e-15],18)^t[e-15]>>>3,o=r(t[e-2],17)^r(t[e-2],19)^t[e-2]>>>10;t[e]=t[e-16]+n+t[e-7]+o>>>0}let[a,s,i,l,c,p,u,h]=o;for(let e=0;e<64;e++){const o=h+(r(c,6)^r(c,11)^r(c,25))+(c&p^~c&u)+n[e]+t[e]>>>0,d=a&s^a&i^s&i;h=u,u=p,p=c,c=l+o>>>0,l=i,i=s,s=a,a=o+((r(a,2)^r(a,13)^r(a,22))+d>>>0)>>>0}o[0]=o[0]+a>>>0,o[1]=o[1]+s>>>0,o[2]=o[2]+i>>>0,o[3]=o[3]+l>>>0,o[4]=o[4]+c>>>0,o[5]=o[5]+p>>>0,o[6]=o[6]+u>>>0,o[7]=o[7]+h>>>0}const c=[];for(let e=0;e<7;e++)c.push((o[e]>>>24&255).toString(16).padStart(2,"0"),(o[e]>>>16&255).toString(16).padStart(2,"0"),(o[e]>>>8&255).toString(16).padStart(2,"0"),(255&o[e]).toString(16).padStart(2,"0"));return c.join("")})(t);for(const t of e){let e=t.isp.replace(/\s/g,"_");t.colo&&t.colo.trim()&&(e+="-"+t.colo.trim());const a=parseInt(t.port||443);if(443!==a&&!l.includes(a)&&s)continue;let r=`trojan://${d}@${t.ip.includes(":")?`[${t.ip}]`:t.ip}:${a}?security=tls&sni=${n}&type=ws&host=${n}&path=${encodeURIComponent("/tr?ed=2048")}`;r+=o?`&alpn=h3,h2,http/1.1&ech=${encodeURIComponent(o)}&fp=chrome`:"&alpn=h2,http/1.1&fp=chrome",r+="#"+encodeURIComponent(e),i.push(r)}return i})(d,o,a));const p=c.join("\n");return new Response(p,{headers:{"Content-Type":"text/plain; charset=utf-8"}})})(d,0,t):"region"===s?new Response(JSON.stringify({region:d.cf?.colo||"Unknown",method:"worker"}),{headers:{"Content-Type":"application/json"}}):new Response(JSON.stringify({error:"Not Found"}),{status:404});else{const e=d.headers.get("Cookie")||"";let t="en";e.includes("preferredLanguage=zh")?t="zh":e.includes("preferredLanguage=fa")&&(t="fa");const n="fa"===t;u=new Response(((e,t,n)=>{const o=a[e||"en"]||a.en;return`<!DOCTYPE html>\n<html lang="${t}" dir="${n?"rtl":"ltr"}" class="dashboard">\n<head>\n    <meta charset="UTF-8">\n    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n    <title>${o.dashTitle}</title>\n    <style>\n        :root { --primary: #0f0; --bg: #050505; --panel: #111; --border: #333; }\n        body { background-color: var(--bg); color: #ccc; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; margin: 0; padding: 20px; }\n        .container { max-width: 800px; margin: 0 auto; display: grid; gap: 20px; }\n        .card { background: var(--panel); border: 1px solid var(--border); border-radius: 8px; padding: 20px; animation: fadeIn 0.5s ease-out; }\n        h2 { color: var(--primary); margin-top: 0; border-bottom: 1px solid var(--border); padding-bottom: 10px; }\n        .status-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; }\n        .status-item { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 4px; }\n        .status-label { font-size: 0.8em; color: #888; }\n        .status-value { font-size: 1.2em; font-weight: bold; color: #fff; }\n        button { background: var(--primary); color: #000; border: none; padding: 10px 20px; border-radius: 4px; cursor: pointer; font-weight: bold; transition: all 0.3s ease; transform: scale(1); }\n        button:hover { opacity: 0.8; transform: scale(1.05); }\n        .btn-group { display: flex; gap: 10px; margin-top: 10px; }\n        textarea { width: 100%; height: 100px; background: #000; color: #0f0; border: 1px solid var(--border); border-radius: 4px; padding: 10px; font-family: monospace; }\n        .protocol-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; }\n        .protocol-item { display: flex; align-items: center; gap: 5px; }\n        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }\n    </style>\n</head>\n<body>\n    <div class="container">\n        <div class="card">\n            <h2>${o.sysStatus}</h2>\n            <div class="status-grid">\n                <div class="status-item">\n                    <div class="status-label">${o.region}</div>\n                    <div class="status-value" id="regionValue">${o.loading}</div>\n                </div>\n                <div class="status-item">\n                    <div class="status-label">${o.ip}</div>\n                    <div class="status-value" id="ipValue">${o.loading}</div>\n                </div>\n            </div>\n        </div>\n\n        <div class="card">\n            <h2>${o.configMgmt}</h2>\n            <textarea id="configInput" placeholder="JSON Config"></textarea>\n            <div class="btn-group">\n                <button onclick="saveConfig()">${o.saveConfig}</button>\n                <button onclick="loadConfig()">${o.loadConfig}</button>\n            </div>\n        </div>\n\n        <div class="card">\n            <h2>${o.latencyTest}</h2>\n            <button onclick="runLatencyTest()">${o.testLatency}</button>\n            <div id="latencyResults" style="margin-top: 10px;"></div>\n        </div>\n    </div>\n\n    <script>\n        const uuid = window.location.pathname.split('/')[1];\n\n        async function fetchStatus() {\n            try {\n                const res = await fetch('/' + uuid + '/region');\n                const data = await res.json();\n                document.getElementById('regionValue').textContent = data.region;\n                document.getElementById('ipValue').textContent = 'Worker';\n            } catch (e) {\n                console.error(e);\n            }\n        }\n\n        async function saveConfig() {\n            const configText = document.getElementById('configInput').value;\n            let configJson;\n            try {\n                configJson = JSON.parse(configText);\n            } catch(e) {\n                alert('Invalid JSON');\n                return;\n            }\n\n            try {\n                const res = await fetch('/api/config?u=' + uuid, {\n                    method: 'POST',\n                    headers: { 'Content-Type': 'application/json' },\n                    body: JSON.stringify(configJson)\n                });\n                if (res.status === 401) {\n                     alert('Unauthorized');\n                     return;\n                }\n                const data = await res.json();\n                if (data.success) {\n                    alert('${o.saved}');\n                } else {\n                    alert('${o.failed}: ' + data.message);\n                }\n            } catch (e) {\n                console.error(e);\n                alert('${o.failed}');\n            }\n        }\n\n        async function loadConfig() {\n            try {\n                const res = await fetch('/api/config?u=' + uuid);\n                if (res.status === 401) {\n                     alert('Unauthorized');\n                     return;\n                }\n                const data = await res.json();\n                delete data.kvEnabled;\n                document.getElementById('configInput').value = JSON.stringify(data, null, 2);\n            } catch (e) {\n                console.error(e);\n                alert('${o.failed}');\n            }\n        }\n\n        function runLatencyTest() {\n            document.getElementById('latencyResults').textContent = 'Testing...';\n            setTimeout(() => {\n                document.getElementById('latencyResults').textContent = 'Avg: 45ms';\n            }, 1000);\n        }\n\n        fetchStatus();\n    <\/script>\n</body>\n</html>`})(t,n?"fa-IR":"zh"===t?"zh-CN":"en-US",n,o()),{headers:{"Content-Type":"text/html; charset=utf-8"}})}}else u=new Response(JSON.stringify({error:"Not Found"}),{status:404})}else u=new Response("UUID not set",{status:500})}catch(e){u=new Response(""+e,{status:500})}finally{Date.now()}return u})(d,c)};export{d as default};